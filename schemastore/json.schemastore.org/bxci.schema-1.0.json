{"$schema":"http://json-schema.org/draft-07/schema","definitions":{"branchPattern":{"type":"string"},"timeout":{"type":"integer"},"credentials":{"type":"string"},"checkmarx":{"type":"object","properties":{"enabled":{"type":"boolean","default":false},"groupId":{"type":"string","default":"55"},"preset":{"type":"string","default":"36"},"projectName":{"type":"string","default":"BSS_BB_Hybrid"},"branch_pattern":{"$ref":"#/definitions/branchPattern","default":"^master$|.*[cC]heck[mM]arx.*"},"useOwnServerCredentials":{"type":"boolean","default":true},"serverUrl":{"type":"string","default":"http://cxpbgmgmtserver/"},"credentialsId":{"type":"string","default":"BB-Checkmarx"},"generatePdfReport":{"type":"boolean","default":true},"sourceEncoding":{"type":"string","default":"5"},"isProxy":{"type":"boolean","default":false},"waitForResultsEnabled":{"type":"boolean","default":true}},"additionalProperties":false},"sonar":{"type":"object","properties":{"enabled":{"type":"boolean","default":true},"breaks_build":{"type":"boolean","default":false},"timeout":{"$ref":"#/definitions/timeout","default":120}},"additionalProperties":false},"stage":{"type":"object","properties":{"steps":{"type":"array"},"when":{"type":"object","properties":{"branch":{"$ref":"#/definitions/branchPattern"}}}},"required":["steps"],"additionalProperties":false},"dockerfile":{"type":"string"},"outputDocker":{"type":"object","properties":{"dockerfile":{"$ref":"#/definitions/dockerfile"},"image_name":{"type":"string"},"publish":{"$ref":"#/definitions/outputDockerPublish"}},"required":["dockerfile","image_name"]},"outputDockerPublish":{"type":"object","properties":{"branch":{"$ref":"#/definitions/branchPattern"},"registry":{"type":"string","format":"uri"},"credentials":{"$ref":"#/definitions/credentials"}},"required":["branch","registry","credentials"]},"outputHelm":{"type":"object","properties":{"path":{"type":"string"},"updates":{"type":"array","items":{"$ref":"#/definitions/outputHelmUpdates"}},"publish":{"$ref":"#/definitions/outputHelmPublish"}},"required":["path","publish","updates"],"additionalProperties":false},"outputHelmUpdates":{"type":"object","additionalProperties":false,"properties":{"file":{"type":"string"},"properties":{"type":"array","items":{"$ref":"#/definitions/outputHelmUpdatesProperties"}}},"required":["file","properties"]},"outputHelmUpdatesProperties":{"type":"object","additionalProperties":false,"properties":{"key":{"type":"string"},"env":{"type":"string","pattern":"^[A-Za-z_][A-Za-z0-9_]*$"},"value":{"type":"string"}},"required":["key"],"oneOf":[{"required":["env"],"not":{"required":["value"]}},{"required":["value"],"not":{"required":["env"]}}]},"outputHelmPublish":{"type":"object","additionalProperties":false,"properties":{"branch":{"$ref":"#/definitions/branchPattern"},"repository":{"type":"string","format":"uri"},"credentials":{"$ref":"#/definitions/credentials"}},"required":["branch","credentials","repository"]}},"properties":{"project":{"type":"object","properties":{"name":{"type":"string"},"type":{"enum":["npm","maven","mvn"],"default":"mvn"},"settings":{"type":"string","examples":["bx-maven-settings","bx-npm-settings"]}},"additionalProperties":false},"config":{"type":"object","properties":{"jenkins_runtime":{"type":"object","properties":{"docker":{"type":"object","properties":{"image":{"type":"string","examples":["remote-host.com/image-name:tag"]},"dockerfile":{"$ref":"#/definitions/dockerfile","examples":[".ci/Dockerfile"]}},"additionalProperties":false}},"additionalProperties":false,"required":["docker"]},"branch":{"type":"object","properties":{"branch_pattern":{"$ref":"#/definitions/branchPattern"},"disable_validation":{"type":"boolean","default":false}},"additionalProperties":false},"build":{"type":"object","properties":{"clean_workspace_after_run":{"type":"boolean","default":true},"checkmarx":{"$ref":"#/definitions/checkmarx"},"static_analysis":{"$ref":"#/definitions/sonar"}},"additionalProperties":false}},"additionalProperties":false,"required":["jenkins_runtime"]},"services":{"type":"array","items":{"enum":["Postgres","Postgis","Redis","Mssql","Mysql","Mongodb","Elasticsearch"]},"uniqueItems":true},"environment":{"type":"object","propertyNames":{"pattern":"^[A-Za-z_][A-Za-z0-9_]*$"}},"jenkinsEnvironment":{"type":"array","uniqueItems":true,"items":{"pattern":"^[A-Za-z_][A-Za-z0-9_]*$","type":"string"}},"stages":{"type":"object","patternProperties":{"^\\w+( \\w+)*$":{"$ref":"#/definitions/stage"}}},"output":{"type":"object","properties":{"docker":{"$ref":"#/definitions/outputDocker"},"helm":{"$ref":"#/definitions/outputHelm"}},"additionalProperties":false},"archive":{"type":"array","examples":["target/*.jar","**/*.jar","target/out.txt"]},"timeout":{"$ref":"#/definitions/timeout","default":600}},"required":["project","config","stages"],"type":"object"}