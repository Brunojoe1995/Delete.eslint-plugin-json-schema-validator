{"$schema":"http://json-schema.org/draft-07/schema","additionalProperties":false,"definitions":{"env":{"type":"object","required":["name","value"],"additionalProperties":false,"properties":{"name":{"type":"string","pattern":"[a-zA-Z_][a-zA-Z_0-9]*"},"value":{"type":"string"},"branch":{"type":"string","default":"*","pattern":"^(\\*)|([a-zA-Z/_-]+\\*)|([a-zA-Z/_-]+)$"}}},"build-condition":{"type":"object","default":{"push":{"branches":["*"]}},"additionalProperties":true,"properties":{"push":{"type":"object","default":{"branches":["*"]},"properties":{"branches":{"type":"array","items":{"type":"string","pattern":"^(\\*)|([a-zA-Z/_-]+\\*)|([a-zA-Z/_-]+)$"},"default":["*"],"minItems":1}},"additionalProperties":false}}},"job":{"type":"object","required":["name","execute"],"additionalProperties":true,"properties":{"name":{"type":"string","pattern":"[a-zA-Z0-9_-]{1,40}"},"execute":{"type":"array","items":{"type":"string","default":"echo \"hello world\""},"minItems":1},"set-proxy":{"type":"array","default":["shell"],"items":{"type":"string","enum":["shell","gradle","npm","docker","yarn","maven"]}},"run-on":{"$ref":"#/definitions/run-on"},"artifacts":{"type":"array","default":[],"items":{"type":"string"}},"caches":{"type":"array","default":[],"items":{"type":"object","additionalProperties":false,"properties":{"key":{"type":"string","pattern":"^[a-zA-Z0-9_-]{1,40}$"},"path":{"type":"string"}}}},"max-execution-time":{"type":"string","default":"1h","pattern":"^([0-9]+)(h|m)$"},"post-process":{"type":"object","additionalProperties":true,"properties":{"app-center-release":{"$ref":"#/definitions/app-center-release"},"git-ops":{"$ref":"#/definitions/git-ops"}}}}},"run-on":{"type":"object","additionalProperties":false,"properties":{"image":{"type":"string","default":"+@basebox","pattern":"^(\\+@[a-z0-9-]+|\\+\\/[a-z0-9-]+|[a-z0-9/.-]+)(:[a-z0-9\\-]+)?$"},"resources":{"anyOf":[{"type":"string","default":"small","enum":["small","medium","large","xlarge","xxlarge","xxxlarge"]},{"type":"object","required":["cpu","memory"],"properties":{"cpu":{"anyOf":[{"type":"string","default":"1.0","pattern":"^[0-9]+(\\.[0-9]+)?$"},{"type":"number","default":1}],"default":"1.0"},"memory":{"type":"string","default":"1Gi","pattern":"^([0-9]+)(Mi|Gi)$"}}}]},"use":{"type":"array","default":[],"items":{"type":"string","enum":["docker","mobil-keystore"]}}}},"app-center-release":{"type":"object","required":["app-id","release-group-tag"],"additionalProperties":true,"properties":{"app-id":{"type":"string","pattern":"[a-zA-Z0-9_-]+"},"release-group-tag":{"type":"string","pattern":"[a-zA-Z0-9_-]+"},"testers":{"type":"array","items":{"type":"string","pattern":"^(@[a-zA-Z0-9_-]+|@@[a-zA-Z0-9_-]+|corp@@[a-zA-Z0-9_-]+)$"}}}},"git-ops":{"type":"object","required":["manifest","update"],"additionalProperties":false,"properties":{"manifest":{"type":"object","required":["repo","branch"],"additionalProperties":false,"properties":{"repo":{"type":"string","pattern":"[a-zA-Z0-9_-]+/[a-zA-Z0-9_-]+"},"branch":{"type":"string","pattern":"[a-zA-Z0-9_-]+"}}},"update":{"type":"array","items":{"type":"string"},"minItems":1},"with-artifacts":{"type":"array","items":{"type":"string"}}}}},"properties":{"on":{"$ref":"#/definitions/build-condition"},"jobs":{"type":"array","items":{"$ref":"#/definitions/job"}},"environment":{"type":"array","items":{"$ref":"#/definitions/env"}}},"required":["jobs"],"title":"kode/ci build spec","type":"object"}